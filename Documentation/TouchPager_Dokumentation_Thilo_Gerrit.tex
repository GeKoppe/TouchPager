\documentclass[a4paper, 11pt]{scrartcl}

\usepackage[utf8]{inputenc}
\usepackage[ngerman]{babel}

\usepackage{mathptmx}
\renewcommand{\familydefault}{\sfdefault}
\usepackage[left=2.5cm, right=2.5cm, top=2.5cm, bottom=2cm]{geometry}
\usepackage[singlespacing]{setspace}

% \usepackage{hyperref}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{floatflt,epsfig}
\usepackage{scrlayer-scrpage}
\usepackage{hyperref}
\usepackage{float}

\usepackage{xcolor}
\usepackage{floatflt,epsfig}
% \usepackage[fleqn]{amsmath}
\usepackage{listings}
\usepackage{color}
%\usepackage{minted}

\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}

% \lstset{frame=tb,
%   language=C,
%   aboveskip=3mm,
%   belowskip=3mm,
%   showstringspaces=false,
%   columns=flexible,
%   basicstyle={\small\ttfamily},
%   numbers=none,
%   numberstyle=\tiny\color{gray},
%   keywordstyle=\color{mauve},
%   commentstyle=\color{dkgreen},
%   stringstyle=\color{blue},
%   breaklines=true,
%   breakatwhitespace=true,
%   tabsize=3,
%   morekeywords={
    
%   }
%   %morecomment=[s][\color{dkgreen}]{//}
% }
\lstset{language=C++,
    basicstyle=\ttfamily,
    keywordstyle=\color{blue}\ttfamily,
    stringstyle=\color{red}\ttfamily,
    commentstyle=\color{green}\ttfamily,
    morecomment=[l][\color{magenta}]{\#}
    morekeywords={
        Messenger,Elegoo_TFTLCD,TouchScreen,VKeys % TODO hier müssen noch die restlichen Keywords eingepflegt werden
    }
}

\begin{document}
\thispagestyle{empty}
\ihead{
    \begin{footnotesize}
        Dokumentation Arduino Pager
    \end{footnotesize}
}
\chead{
    \begin{footnotesize}
        Lernfeld 7: Cyberphysische Systeme ergänzen
    \end{footnotesize}
}
\ohead{
    \begin{footnotesize}
        Thilo Drehlmann, Gerrit Koppe
    \end{footnotesize}
}
\vspace{0.2\textheight}
\begin{center}
    \begin{figure}[H]
        \begin{minipage}{0.3\textwidth}
            \includegraphics[scale=0.6]{Bilder/BBS}
        \end{minipage}
        \hspace{0.48\textwidth}
        \begin{minipage}{0.3\textwidth}
            \includegraphics[scale=0.6]{Bilder/sievers.png}
        \end{minipage}
    \end{figure}
    \vspace{1cm}
    \begin{Huge}
        \textbf{Dokumentation Arduino Pager} 
    \end{Huge}
    \\
    \vspace{0.1\textheight}
    \begin{Large}
        Autoren: Thilo Drehlmann, Gerrit Koppe
    \end{Large}
    \\
    \vspace{0.5cm}
    \begin{Large}
        Ausbildungsberuf: Fachinformatiker für Anwendungsentwicklung
    \end{Large}
    \\
    \vspace{0.5cm}
    \begin{Large}
        \today
    \end{Large}
\end{center}
\newpage
\thispagestyle{empty}
\tableofcontents
\newpage
\clearpage
\pagenumbering{arabic}
\section{Einleitung}
In dieser Dokumentation wird die Umsetzung eines bidirektionalen Pagers auf Basis der Arduino Plattform beschrieben. Zunächst werden Thema und Ziel des Projekts formuliert.
Anschließend wird auf die Planung der Ressourcen und des Ablaufs, sowie auf die benötigten Komponenten eingegangen. Im Anschluss wird das Vorgehen während des Projektes dokumentiert
und abschließend das Ergebnis der Durchführung präsentiert.

\section{Formulierung des Themas}
\subsection{Beschreibung des Projektes}
Das Thema des Projektes ist es, eine bidirektionale Kommunikation zwischen zwei Geräten auf Arduino-Basis zu gewährleisten. Es soll die Möglichkeit bestehen,
Nachrichten zu verfassen, zu versenden und ebenso Nachrichten zu empfangen, die von einem anderen Arduino Gerät versendet wurden.

\subsection{Definition der Ziele, erwartetes Ergebnis}
Im Folgenden werden die allgemein Ziele des Projektes näher definiert.
\\
\\
1. Es soll möglich sein, mittels eines Touchscreens und einer virtuellen Tastatur, Zeichenketten auf einem, an den Arduino angeschlossenen Touchscreen, zu schreiben.
\\
2. Die eingegebenen Zeichenketten sollen, mittels Funkwellen, an ein anderes Gerät übertragen werden können.
\\
3. Das Gerät soll in der Lage sein, Funkwellen zu empfangen.
\\
4. Das Gerät soll außerdem in der Lage sein, die empfangenen Funkwellen wieder zu einer Zeichenkette zu übersetzen und auf einem Touchscreen anzuzeigen.
\\
5. Es soll ein graphisches User Interface auf dem Touchscreen geben.
\\
6. Es soll möglich sein, empfangene Nachrichten zwischenzuspeichern, damit neu empfangene Nachrichten nicht die vorherigen Nachrichten überschreiben.
\\
7. Es soll möglich sein, den Zwischenspeicher der Nachrichten über einen eigenen Menüpunkt abzurufen und die empfangenen Nachrichten zu verwalten.
\\
\\
Außerdem gibt es folgende, optionale Ziele:
\\
\\
a. Das User Interface soll farblich angepasst werden können.
\\
b. Es soll möglich sein, zu überprüfen, ob empfangsbereite Geräte in der Nähe sind.


\section{Ressourcen und Ablaufplanung}
\subsection{Planung der Umsetzung}\label{ch:planning}
Das Projekt besteht aus zwei Teilen, der drahtlosen Kommunikation zweier Arduino Geräte miteinander und dem User Interface / der menschlichen Schnittstelle mit der
Hardware, über die Nachrichten angezeigt, aber auch eingegeben und versendet werden können. Für die Planung ist also zunächst relevant, welche Hardware Komponenten benötigt werden, 
um beide Projektteile umzusetzen.
\\
Für die drahtlose Kommunikation kann auf verschiedene Technologien wie Bluetooth oder Radio-Frequenz zurückgegriffen werden. Da Bluetooth nur eine sehr eingeschränkte
Reichweite besitzt und eine Kopplung der Geräte notwendig ist, haben wir uns dafür entschieden, die drahtlose Übertragung per Radiofrequenz durchzuführen. Außerdem existieren
für eine solche Übertragung kostengünstige Hardware und fertige API-Bibliotheken für die Hardware. Aus diesen Gründen wurde sich für die nRF24L01+ Transceiver 
(im Folgenden als \glqq Antenne\grqq{} oder \glqq Transceiver\grqq{} bezeichnet) entschieden.\footnote{Vgl. Hardware Link~\ref{itm:transceiverlink}}
\\
Für die Umsetzung der menschlichen Schnittstelle sollten zunächst ein Numpad, sowie ein 16x2 Liquid Crystal Display verwendet werden. Aufgrund der stark eingeschränkten Nutzbarkeit des LCD,
sowie umständlicher Eingabe über das Numpad, wurde sich stattdessen entschieden, einen Touchscreen zu verwenden. Da bereits Arduino Uno R3 Boards der Marke Elegoo zur Verfügung standen,
wurde sich hier für den Elegoo TFT 2,8'' Touchscreen (im Folgenden als \glqq TFT\grqq{} oder \glqq Touchschreen\grqq{} bezeichnet) entschieden.\footnote{Vgl. Hardware Link~\ref{itm:tftlink}} Dieser
hat außerdem den Vorteil, dass Elegoo Bibliotheken mitliefert, um den Touchscreen zu programmieren.
\\
Schlussendlich musste noch entschieden werden, welches Arduino Board verwendet werden sollte. Aufgrund guter Erfahrung mit der Marke Elegoo in Hinsicht auf Zuverlässigkeit und Nutzbarkeit, wurde sich für
ebenjene Marke entschieden. Da der Touchscreen als Shield\footnote{Vgl. Glossar~\ref{def:shield}: Shield} für Arduino Uno Boards konzipiert ist, wäre es bei einem Arduino Uno nicht mehr möglich,
weitere Hardware Komponenten anzuschließen. Entsprechend fiel die Entscheidung auf den Elegoo Arduino Mega R3\footnote{Vgl. Hardware Link~\ref{itm:arduinolink}}, da dieser deutlich mehr Pinouts zur Verfügung
stellt, als ein Arduino Uno. Weitere Gründe für diese Entscheidung sind, dass der Transceiver über den SPI Bus des Arduinos kommuniziert, dieser wäre bei einem Arduino Uno aber durch den TFT blockiert. Außerdem
wird viel Quellcode erwartet, was bedeutet, dass der Programmierspeicher des Arduino Uno zu klein sein könnte, auch hier hat der Arduino Mega mehr Ressourcen.

\subsection{Ressourcen}

\subsubsection{Benötigte Hardware}
In Anhang Tabelle~\ref{tab:hardware} findet sich eine detaillierte, tabellarische Auflistung aller in Kapitel~\ref{ch:planning} genannten Komponenten, ihrer Aufgaben und ihrer Preise.
Alle Komponenten werden zwei mal benötigt, da eine Kommunikation zwischen zwei identischen Geräten hergestellt werden soll.

\subsubsection{Benötigte Software}
Zur Umsetzung des Projekts wird, um die Programmierung zu vereinfachen und den Quellcode schlanker zu halten, auf verschiedene externe Bibliotheken zurückgegriffen.
Eine detaillierte Auflistung dieser Bibliotheken findet sich im Anhang Tabelle~\ref{tab:software}.

\subsection{Planung der Umsetzung}
Um das Projekt sinnvoll zu strukturieren, wurden zunächst Teilziele definiert, die nacheinander umgesetzt werden sollen.
\\
Als erstes sollen grundlegende Funktionalitäten entwickelt werden, wie zum Beispiel das  

\subsubsection{Teilziele}
\begin{enumerate}
    \item \textit{Vordefinierte Nachricht unidirektional übertragen}: Zunächst soll eine statisch eingestellte Nachricht zwischen zwei Arduino Mega mittels nRF24L01+ Transceiver
            Übertragen werden können, um zu prüfen, ob die Verbindung hergestellt werden kann.
    \item \textit{}
\end{enumerate}

\subsubsection{Erwartete Schwierigkeiten}
Im Folgenden werden alle Schwierigkeiten aufgelistet und erklärt, die während der Umsetzung des Projekts erwartet werden.
\begin{enumerate}
    \item \textit{Fehlersuche bei fehlerhafter Übertragung}: Da dieses Projekt darauf basiert, Funksignale zu versenden und zu empfangen und die Umsetzenden keine Gerätschaft
            besitzen, Funkwellen und Signalstärken dieser zu messen, wird es schwierig, den Fehler zu identifizieren, sollte eine Übertragung fehlschlagen.
    \item \textit{Distanzregulierung}: Die Transceiver können in verschiedenen Signalstärken senden, die programmatisch eingestellt werden müssen.
            Wird eine zu hohe Signalstärke konfiguriert, leidet darunter allerdings die Übertragungsqualität bei niedrigen Distanzen. Hier muss ein gutes Mittelmaß
            gefunden werden.
    \item \textit{Wechsel zwischen Empfang und Senden}: Da die Nachrichten bidirektional versendet werden sollen, die Transceiver aber nur halbduplex arbeiten,
            muss ein rechtzeitiger Wechsel der Antenne zwischen Senden und Empfang garantiert werden. Sollten beide Geräte gleichzeitig Senden, werden beide Nachrichten
            verloren gehen.
    \item \textit{Empfang garantieren}: Da die Möglichkeit bestehen soll, gleich 
    \item \textit{Kein Multithreading}: Da Arduinos nicht Multithreading-fähig\footnote{vgl. Glossar~\ref{def:multithreading}: Multithreading} sind, wird eine Schwierigkeit
            darin bestehen, permanent gleichzeitig die Nutzung des Geräts und den Empfang eingehender Nachrichten zu gewährleisten.
\end{enumerate}

\subsubsection{Zeitliche Planung}

\subsubsection{Arbeitsaufteilung}

\section{Durchführung}


\section{Projektergebnis}

\newpage
\section{Anlagen}
\begin{small}

\begin{table}[H]
    \caption{Benötigte Hardware}\label{tab:hardware}
    \begin{tabular}{|p{0.3\textwidth}|p{0.5\textwidth}|p{0.1\textwidth}|}
        \hline
        \textbf{Hardware} & \textbf{Aufgabe} & \textbf{Kosten}
        \\
        \hline\hline
        Arduino Mega 2560 
        & 
        \begin{itemize}
            \item Zentrale Schnittstelle aller Komponenten
            \item Verwaltung der Logik / Programmierbarkeit
            \item 
        \end{itemize} 
        & 
        21,99€
        \\
        \hline
        Elegoo Uno TFT Touchscreen 2,8''
        &
        \begin{itemize}
            \item Anzeige von Nachrichten
            \item Eingabe von Nachrichten
            \item User Interface
        \end{itemize}
        &
        19,99€
        \\
        \hline
        nRF24L01+ Wireless Transceiver Modul
        &
        \begin{itemize}
            \item Nachrichten Übertragen und Empfangen
            \item Überprüfung Verfügbarkeit anderer Geräte
        \end{itemize}
        &
        5,-€
        \\
        \hline
    \end{tabular}
\end{table}
Links zur genutzten Hardware sind in Kapitel~\ref{ch:hardwarelinks} aufgeführt.

\begin{table}[H]
    \caption{Benötigte Software}\label{tab:software}
    \begin{tabular}{|p{0.2\textwidth}|p{0.5\textwidth}|p{0.2\textwidth}|}
        \hline
        \textbf{Bibliothek} & \textbf{Aufgabe} & \textbf{Quelle}
        \\
        \hline\hline
        Elegoo\text{\_}GFX.h 
        & 
        Kern Grafikbibliothek des Elegoo Uno TFT Touchscreens. Ermöglicht das Drucken von Zeichen / Formen auf TFT Display.
        &
        Mitgeliefert auf CD bei TFT Touchscreen
        \\
        \hline
        Elegoo\text{\_}TFTLCD.h
        &
        Hardware-Bibliothek des Elegoo Uno TFT Touchscreens. Verantwortlich für die Kommunikation des Programms mit der Hardware.
        &
        Mitgeliefert auf CD bei TFT Touchscreen
        \\
        \hline
        TouchScreen.h
        &
        Bibliothek des Touchscreens des Elegoo Uno TFT Touchscreens. Erlaubt das erkennen von Berührungen des Touchscreens und die Lokalisierung der
        Berührung.
        &
        Mitgeliefert auf CD bei TFT Touchscreen
        \\
        \hline
        SPI.h
        &
        Erlaubt die Kommunikation des Programms mit dem SPI Bus des Arduino Board
        &
        In Arduino IDE inkludiert
        \\
        \hline
        nRF24L01.h
        &
        Hardware Bibliothek der nRF24L01+ Transceiver. Erlaubt Kommunikation des Moduls mit dem Arduino Board
        &
        Github %TODO die Quellen ALLE noch mal checken und anpassen
        \\
        \hline
        RF24.h
        &
        Programmierbare Schnittstelle der nRF24L01+ Transceiver. 
        &
        Github
        \\
        \hline
        Arduino.h
        &
        Liefert Kernfunktionen der Arduino Boards.
        &
        In Arduino IDE inkludiert
        \\
        \hline
    \end{tabular}
\end{table}
Links zur genutzten Software sind in Kapitel~\ref{ch:softwarelinks} aufgeführt.


\end{small}
\newpage
\section{Glossar}
\subsection{Technische Begriffe}
\textbf{Multithreading\label{def:multithreading}}
\\
Unter Multithreading versteht man in der Informatik den Prozess, ein Programm in mehrere Teilstränge aufzuteilen, die parallel 
ausgeführt werden.\footnote{Vgl. Internetquelle~\ref{itm:multithread}}
\subsection{Arduino Begriffe}
\textbf{Shield\label{def:shield}}
\\
Ein Shield ist ein Schaltplatte, die die Funtkionalität eines Arduinos erweitern kann und meistens so konzeptioniert ist, dass sie direkt in den Arduino gesteckt werden kann und diesen somit
zum Teil oder vollständig abdeckt.\footnote{Vgl. Internetquelle~\ref{itm:shield}}
\newpage
\section{Quellenverzeichnis}
\subsection{Internetquellen}
\begin{enumerate}
    \item Storage Insider: Was ist Multithreading - Online unter \url{https://www.storage-insider.de/was-ist-multithreading-a-1017586/} $\left[\text{07.01.2023}\right]$ \label{itm:multithread}
    \item Computer Hope: Arduino Shield - Online unter \url{https://www.shorturl.at/bFKNO} $\left[\text{07.01.2023}\right]$ \label{itm:shield}
\end{enumerate}

\subsection{Links genutzter Hardware}\label{ch:hardwarelinks}
\begin{enumerate}
    \item nRF24L01+ Transceiver: \url{https://www.shorturl.at/fuLX0}\label{itm:transceiverlink}
    \item Elegoo Arduino Mega R3: \url{https://www.shorturl.at/XZ238}\label{itm:arduinolink}
    \item Elegoo TFT Touchscreen: \url{https://www.shorturl.at/dvXY7}\label{itm:tftlink}
\end{enumerate}

\subsection{Links genutzter Software}\label{ch:softwarelinks}
\begin{enumerate}
    \item 
\end{enumerate}

\end{document}